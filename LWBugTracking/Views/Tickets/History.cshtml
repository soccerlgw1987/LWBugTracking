@using Microsoft.AspNet.Identity
@model LWBugTracking.Models.Ticket
@using LWBugTracking.Helper
@using LWBugTracking.Models
@using System.Web.Configuration;
<section role="main" class="content-body">
    <header class="page-header">
        <h2>History</h2>

        <div class="right-wrapper pull-right">
            <ol class="breadcrumbs">
                <li>
                    <a href="@Url.Action("Index","Home")">
                        <i class="fa fa-home"></i>
                    </a>
                </li>
                <li><span>Dashboard</span></li>
                <li><span>Tickets</span></li>
                <li><span>Ticket History</span></li>
            </ol>

            <a class="sidebar-right-toggle" data-open="sidebar-right"><i class="fa fa-chevron-left"></i></a>
        </div>
    </header>

    <!-- start: page -->

    <div class="timeline">
        <div class="tm-body">
            <div class="tm-title">
                <h3 class="h5 text-uppercase">@DateTime.Now.ToString("MMMM dd, yyyy")</h3>
            </div>
            <ol class="tm-items">
                @foreach (var item in Model.TicketHistories.OrderByDescending(c => c.Changed))
                {
                    if (item.OldValue != item.NewValue)
                    {
                        if (item.PropertyName == "AssignedToUserId")
                        {
                            <li>
                                <div class="tm-info">
                                    <div class="tm-icon"><i class="fa fa-bell"></i></div>
                                    <time class="tm-datetime" datetime="2013-11-19 18:13">
                                        <div class="tm-datetime-date">@item.Changed.ToString("MMMM dd, yyyy")</div>
                                        <div class="tm-datetime-time">@item.Changed.ToString("h:mm tt")</div>
                                    </time>
                                </div>
                                <div class="tm-box appear-animation" data-appear-animation="fadeInRight" data-appear-animation-delay="250">

                                    <p>
                                        Assigned Developer changed from @LookupData.GetNameFromId(item.PropertyName, item.OldValue) to @LookupData.GetNameFromId(item.PropertyName, item.NewValue)
                                        <br />
                                        Changed by @item.User.FirstName @item.User.LastName
                                    </p>

                                </div>
                            </li>
                        }
                        else if (item.PropertyName == "TicketPriorityId")
                        {
                            <li>
                                <div class="tm-info">
                                    <div class="tm-icon"><i class="fa fa-star"></i></div>
                                    <time class="tm-datetime" datetime="2013-11-19 18:13">
                                        <div class="tm-datetime-date">@item.Changed.ToString("MMMM dd, yyyy")</div>
                                        <div class="tm-datetime-time">@item.Changed.ToString("h:mm tt")</div>
                                    </time>
                                </div>
                                <div class="tm-box appear-animation" data-appear-animation="fadeInRight" data-appear-animation-delay="250">

                                    <p>
                                        Priority changed from @LookupData.GetNameFromId(item.PropertyName, item.OldValue) to @LookupData.GetNameFromId(item.PropertyName, item.NewValue)
                                        <br />
                                        Changed by @item.User.FirstName @item.User.LastName
                                    </p>

                                </div>
                            </li>
                        }
                        else if (item.PropertyName == "TicketStatusId")
                        {
                            <li>
                                <div class="tm-info">
                                    <div class="tm-icon"><i class="fa fa-support"></i></div>
                                    <time class="tm-datetime" datetime="2013-11-19 18:13">
                                        <div class="tm-datetime-date">@item.Changed.ToString("MMMM dd, yyyy")</div>
                                        <div class="tm-datetime-time">@item.Changed.ToString("h:mm tt")</div>
                                    </time>
                                </div>
                                <div class="tm-box appear-animation" data-appear-animation="fadeInRight" data-appear-animation-delay="250">

                                    <p>
                                        Status changed from @LookupData.GetNameFromId(item.PropertyName, item.OldValue) to @LookupData.GetNameFromId(item.PropertyName, item.NewValue)
                                        <br />
                                        Changed by @item.User.FirstName @item.User.LastName
                                    </p>

                                </div>
                            </li>
                        }
                        else if (item.PropertyName == "TicketTypeId")
                        {
                            <li>
                                <div class="tm-info">
                                    <div class="tm-icon"><i class="fa fa-file"></i></div>
                                    <time class="tm-datetime" datetime="2013-11-19 18:13">
                                        <div class="tm-datetime-date">@item.Changed.ToString("MMMM dd, yyyy")</div>
                                        <div class="tm-datetime-time">@item.Changed.ToString("h:mm tt")</div>
                                    </time>
                                </div>
                                <div class="tm-box appear-animation" data-appear-animation="fadeInRight" data-appear-animation-delay="250">

                                    <p>
                                        Type changed from @LookupData.GetNameFromId(item.PropertyName, item.OldValue) to @LookupData.GetNameFromId(item.PropertyName, item.NewValue)
                                        <br />
                                        Changed by @item.User.FirstName @item.User.LastName
                                    </p>

                                </div>
                            </li>
                        }
                        else if (item.PropertyName == "Title")
                        {
                            <li>
                                <div class="tm-info">
                                    <div class="tm-icon"><i class="fa fa-briefcase"></i></div>
                                    <time class="tm-datetime" datetime="2013-11-19 18:13">
                                        <div class="tm-datetime-date">@item.Changed.ToString("MMMM dd, yyyy")</div>
                                        <div class="tm-datetime-time">@item.Changed.ToString("h:mm tt")</div>
                                    </time>
                                </div>
                                <div class="tm-box appear-animation" data-appear-animation="fadeInRight" data-appear-animation-delay="250">

                                    <p>
                                        Title changed from @item.OldValue to @item.NewValue
                                        <br />
                                        Changed by @item.User.FirstName @item.User.LastName
                                    </p>

                                </div>
                            </li>
                        }
                        else
                        {
                            <li>
                                <div class="tm-info">
                                    <div class="tm-icon"><i class="fa fa-book"></i></div>
                                    <time class="tm-datetime" datetime="2013-11-19 18:13">
                                        <div class="tm-datetime-date">@item.Changed.ToString("MMMM dd, yyyy")</div>
                                        <div class="tm-datetime-time">@item.Changed.ToString("h:mm tt")</div>
                                    </time>
                                </div>
                                <div class="tm-box appear-animation" data-appear-animation="fadeInRight" data-appear-animation-delay="250">

                                    <p>
                                        Description changed from @item.OldValue to @item.NewValue
                                        <br />
                                        Changed by @item.User.FirstName @item.User.LastName
                                    </p>

                                </div>
                            </li>
                        }

                    }
                }
            </ol>
            <div class="tm-title">
                <h3 class="h5 text-uppercase">@Model.Created.ToString("MMMM dd, yyyy - h:mm tt")</h3>
            </div>
        </div>
    </div>


    <!-- end: page -->

</section>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}


